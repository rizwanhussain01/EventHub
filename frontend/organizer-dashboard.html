<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Organizer Dashboard - EventHub</title>
  
  <link rel="stylesheet" href="css/global.css">
  <link rel="stylesheet" href="css/animations.css">
  <link rel="stylesheet" href="css/components.css">
  <link rel="stylesheet" href="css/responsive.css">
  <!-- QR Scanner Library -->
  <script src="https://unpkg.com/html5-qrcode"></script>
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar">
    <div class="container">
      <a href="index.html" class="navbar-brand">âœ¨ EventHub</a>
      <div class="navbar-menu" id="navbarMenu">
        <div id="authLinks"></div>
      </div>
      <button class="navbar-toggle" onclick="toggleMobileMenu()">â˜°</button>
    </div>
  </nav>

  <!-- Dashboard Section -->
  <section class="section" style="padding-top: 100px;">
    <div class="container">
      <div class="dashboard-header fade-in">
        <div>
          <h1>Organizer Dashboard</h1>
          <p>Manage your events and track performance</p>
        </div>
        <div style="display:flex;gap:18px;">
          <!-- New AI Planner Button -->
          <a href="ai-planner.html" class="btn btn-accent" style="font-weight:500;box-shadow:0 1px 8px #cabbff;">
            ðŸ¦¾ AI Planner
          </a>
          <a href="create-event.html" class="btn btn-primary">
            + Create New Event
          </a>
        </div>
      </div>
      <!-- Stats Cards -->
      <div class="stats-grid fade-in stagger-1" id="statsGrid">
        <!-- Stats will be loaded here -->
      </div>
      <!-- My Events Section -->
      <div class="dashboard-section">
        <h2>My Events</h2>
        <div class="events-table-container glass-card" id="eventsTableContainer">
          <!-- Events table will be loaded here -->
        </div>
        <button class="btn btn-secondary" onclick="openQRModal()" style="margin:1.5rem 0;">
          ðŸŽ« Scan Ticket QR
        </button>
      </div>
    </div>
  </section>
  
  <!-- Edit Event Modal -->
  <div id="editModal" class="modal">
    <div class="modal-content" style="max-width: 700px;">
      <div class="modal-header">
        <h3>Edit Event</h3>
        <button class="modal-close" onclick="closeEditModal()">&times;</button>
      </div>
      <form id="editEventForm">
        <input type="hidden" id="editEventId">
        <div class="form-group">
          <label class="form-label">Event Title</label>
          <input type="text" name="title" class="form-input" required>
        </div>
        <div class="form-group">
          <label class="form-label">Description</label>
          <textarea name="description" class="form-textarea" required></textarea>
        </div>
        <div class="form-row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
          <div class="form-group">
            <label class="form-label">Category</label>
            <select name="category" class="form-select" required>
              <option value="Conference">Conference</option>
              <option value="Workshop">Workshop</option>
              <option value="Seminar">Seminar</option>
              <option value="Webinar">Webinar</option>
              <option value="Meetup">Meetup</option>
              <option value="Concert">Concert</option>
              <option value="Sports">Sports</option>
              <option value="Exhibition">Exhibition</option>
              <option value="Other">Other</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">Capacity</label>
            <input type="number" name="capacity" class="form-input" required>
          </div>
        </div>
        <div class="form-group">
          <label style="display: flex; align-items: center; gap: 0.5rem;">
            <input type="checkbox" name="isPublished" style="width: auto;">
            <span class="form-label" style="margin: 0;">Published</span>
          </label>
        </div>
        <div style="display: flex; gap: 1rem; justify-content: flex-end; margin-top: 1.5rem;">
          <button type="button" onclick="closeEditModal()" class="btn btn-secondary">Cancel</button>
          <button type="submit" class="btn btn-primary" id="updateBtn">Update Event</button>
        </div>
      </form>
    </div>
  </div>
  <!-- Delete Confirmation Modal -->
  <div id="deleteModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Delete Event?</h3>
        <button class="modal-close" onclick="closeDeleteModal()">&times;</button>
      </div>
      <div style="padding: 1.5rem 0;">
        <p>Are you sure you want to delete this event? All registered tickets will be cancelled.</p>
        <p style="color: var(--danger-color); margin-top: 0.5rem;">This action cannot be undone.</p>
      </div>
      <div style="display: flex; gap: 1rem; justify-content: flex-end;">
        <button onclick="closeDeleteModal()" class="btn btn-secondary">Cancel</button>
        <button onclick="confirmDelete()" class="btn btn-danger" id="confirmDeleteBtn">Delete Event</button>
      </div>
    </div>
  </div>
  <!-- View Attendees Modal -->
  <div id="attendeesModal" class="modal">
    <div class="modal-content" style="max-width: 700px;">
      <div class="modal-header">
        <h3>Event Attendees</h3>
        <button class="modal-close" onclick="closeAttendeesModal()">&times;</button>
      </div>
      <div id="attendeesList" style="max-height: 400px; overflow-y: auto;">
        <!-- Attendees will be loaded here -->
      </div>
    </div>
  </div>
  <!-- QR Code Scanner Modal -->
  <div id="qrModal" class="modal">
    <div class="modal-content" style="max-width:400px;text-align:center;">
      <div class="modal-header">
        <h3>Scan Ticket QR</h3>
        <button class="modal-close" onclick="closeQRModal()">&times;</button>
      </div>
      <div style="padding:1rem 0;">
        <div id="qr-reader" style="width:100%;max-width:340px;margin:auto;"></div>
        <div id="qr-reader-results" style="margin-top:1rem;color:var(--primary-color);font-weight:500;"></div>
      </div>
    </div>
  </div>

  <script src="js/config.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/api.js"></script>
  <script src="js/utils.js"></script>
  <script src="js/organizer-dashboard.js"></script>

  <style>
    .dashboard-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 3rem; flex-wrap: wrap; gap: 1rem;}
    .dashboard-header .btn-accent { background: linear-gradient(90deg,#985fff,#d97ed8); color:#fff;border:none;}
    .dashboard-header .btn-accent:hover { background: linear-gradient(90deg,#bf99ff,#f29ee0); }
    .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-bottom: 3rem;}
    .stat-card { background: var(--bg-card); border: 1px solid var(--glass-border); border-radius: var(--radius-lg); padding: 1.5rem; transition: var(--transition-normal);}
    .stat-card:hover { transform: translateY(-4px); box-shadow: var(--shadow-md);}
    .stat-icon { font-size: 2.5rem; margin-bottom: 0.5rem;}
    .stat-value { font-size: 2rem; font-weight: 700; color: var(--primary-color); margin: 0.5rem 0;}
    .stat-label { color: var(--text-secondary); font-size: 0.875rem;}
    .dashboard-section { margin-top: 3rem;}
    .events-table-container { padding: 1.5rem; overflow-x: auto;}
    .events-table { width: 100%; border-collapse: collapse;}
    .events-table th { text-align: left; padding: 1rem; color: var(--text-secondary); font-weight: 600; border-bottom: 2px solid var(--glass-border);}
    .events-table td { padding: 1rem; border-bottom: 1px solid var(--glass-border); color: var(--text-primary);}
    .events-table tr:hover { background: var(--glass-bg);}
    .action-buttons { display: flex; gap: 0.5rem;}
    .attendee-item { display: flex; align-items: center; justify-content: space-between; padding: 1rem; border-bottom: 1px solid var(--glass-border);}
    .attendee-info h4 { margin: 0; font-size: 0.95rem;}
    .attendee-info p { margin: 0.25rem 0 0 0; font-size: 0.875rem; color: var(--text-secondary);}
    /* QR modal override */
    #qrModal .modal-content {
      min-height: 420px;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      padding-bottom: 2rem;
    }
    #qr-reader {
      background: #181825;
      border-radius: 14px;
      box-shadow: 0 1px 8px rgba(31,0,61,0.07);
      margin-bottom: 12px;
    }
    @media (max-width: 768px) {
      .dashboard-header { flex-direction: column; align-items: flex-start;}
      .events-table { font-size: 0.875rem;}
      .events-table th,.events-table td { padding: 0.75rem 0.5rem;}
      #qrModal .modal-content { min-width: 94vw; }
    }
  </style>
</body>
</html>
